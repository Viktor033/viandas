import{a as Y,c as $,d as J}from"./chunk-GMOZJTMW.js";import{b as N,c as D,d as j,e as B,f as W,g as q,h as R,m as L,n as G,o as H}from"./chunk-WBCBZC34.js";import{$ as F,C as M,G as f,J as m,M as i,N as r,O as b,P as C,Q as u,R as d,T as c,U as T,V as h,X as v,Y as w,Z as O,ba as A,d as Z,ja as U,ka as S,l as P,na as z,o as g,pa as y,q as l,r as s,ra as k,u as V,x,z as a}from"./chunk-GBG54TIV.js";function te(n,_){if(n&1){let e=C();i(0,"button",9),u("click",function(){l(e);let t=d();return s(t.onAdd())}),c(1," Agregar "),r()}}function ne(n,_){if(n&1){let e=C();i(0,"button",10),u("click",function(){l(e);let t=d();return s(t.onDelete())}),c(1," Eliminar "),r()}}var K=(()=>{class n{product;isAdmin=!1;addToCart=new V;deleteProduct=new V;onAdd(){this.addToCart.emit(this.product)}onDelete(){this.product.id&&this.deleteProduct.emit(this.product.id)}static \u0275fac=function(o){return new(o||n)};static \u0275cmp=M({type:n,selectors:[["app-product-card"]],inputs:{product:"product",isAdmin:"isAdmin"},outputs:{addToCart:"addToCart",deleteProduct:"deleteProduct"},decls:14,vars:10,consts:[[1,"product-card"],[1,"image-container"],[3,"src","alt"],[1,"card-details"],[1,"description"],[1,"price-row"],[1,"price"],["class","btn-add",3,"click",4,"ngIf"],["class","btn-delete",3,"click",4,"ngIf"],[1,"btn-add",3,"click"],[1,"btn-delete",3,"click"]],template:function(o,t){o&1&&(i(0,"div",0)(1,"div",1),b(2,"img",2),r(),i(3,"div",3)(4,"h3"),c(5),r(),i(6,"p",4),c(7),r(),i(8,"div",5)(9,"span",6),c(10),F(11,"number"),r(),f(12,te,2,0,"button",7)(13,ne,2,0,"button",8),r()()()),o&2&&(a(2),m("src",t.product.imagenUrl||"/assets/images/placeholder-food.png",x)("alt",t.product.nombre),a(3),T(t.product.nombre),a(2),T(t.product.descripcion),a(3),h("$ ",A(11,7,t.product.precio,"1.0-0"),""),a(2),m("ngIf",!t.isAdmin),a(),m("ngIf",t.isAdmin))},dependencies:[y,S,z],styles:[".product-card[_ngcontent-%COMP%]{background:#fff;background:#28282899;backdrop-filter:blur(10px);border:1px solid rgba(237,177,16,.1);border-radius:16px;overflow:hidden;transition:transform .3s ease,box-shadow .3s ease;display:flex;flex-direction:column;height:100%;color:#f8edda}.product-card[_ngcontent-%COMP%]:hover{transform:translateY(-5px);box-shadow:0 10px 20px #0000004d;border-color:#edb11066}.product-card[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]{height:180px;width:100%;overflow:hidden}.product-card[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover;transition:transform .5s ease}.product-card[_ngcontent-%COMP%]:hover   .image-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{transform:scale(1.1)}.product-card[_ngcontent-%COMP%]   .card-details[_ngcontent-%COMP%]{padding:1.2rem;display:flex;flex-direction:column;flex-grow:1}.product-card[_ngcontent-%COMP%]   .card-details[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 .5rem;font-size:1.1rem;color:#edb110}.product-card[_ngcontent-%COMP%]   .card-details[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]{font-size:.9rem;color:#f8eddab3;margin-bottom:1rem;flex-grow:1}.product-card[_ngcontent-%COMP%]   .card-details[_ngcontent-%COMP%]   .price-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-top:auto}.product-card[_ngcontent-%COMP%]   .card-details[_ngcontent-%COMP%]   .price-row[_ngcontent-%COMP%]   .price[_ngcontent-%COMP%]{font-size:1.2rem;font-weight:700;color:#fff}.product-card[_ngcontent-%COMP%]   .card-details[_ngcontent-%COMP%]   .price-row[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:.5rem 1rem;border:none;border-radius:8px;cursor:pointer;font-weight:600;transition:all .2s}.product-card[_ngcontent-%COMP%]   .card-details[_ngcontent-%COMP%]   .price-row[_ngcontent-%COMP%]   button.btn-add[_ngcontent-%COMP%]{background:#edb110;color:#0a332e}.product-card[_ngcontent-%COMP%]   .card-details[_ngcontent-%COMP%]   .price-row[_ngcontent-%COMP%]   button.btn-add[_ngcontent-%COMP%]:hover{background:#ffca2c}.product-card[_ngcontent-%COMP%]   .card-details[_ngcontent-%COMP%]   .price-row[_ngcontent-%COMP%]   button.btn-delete[_ngcontent-%COMP%]{background:#dc3545!important;color:#fff!important;border:none;opacity:1!important}.product-card[_ngcontent-%COMP%]   .card-details[_ngcontent-%COMP%]   .price-row[_ngcontent-%COMP%]   button.btn-delete[_ngcontent-%COMP%]:hover{background:#c82333!important;transform:scale(1.05)}"]})}return n})();var Q=(()=>{class n{http=g(k);apiUrl="/api/productos";getProductos(){return this.http.get(this.apiUrl)}createProducto(e){return this.http.post(this.apiUrl,e)}deleteProducto(e){return this.http.delete(`${this.apiUrl}/${e}`)}static \u0275fac=function(o){return new(o||n)};static \u0275prov=P({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var X=(()=>{class n{http=g(k);apiUrl="/api/upload";uploadImage(e){let o=new FormData;return o.append("file",e),this.http.post(this.apiUrl,o)}static \u0275fac=function(o){return new(o||n)};static \u0275prov=P({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var E=Z($());function oe(n,_){if(n&1){let e=C();i(0,"button",7),u("click",function(){l(e);let t=d();return s(t.toggleForm())}),b(1,"i",8),c(2),r()}if(n&2){let e=d();a(2),h(" ",e.showForm?"Cancelar":"Nuevo Producto"," ")}}function re(n,_){n&1&&(i(0,"div",21),c(1,"Subiendo imagen..."),r())}function ie(n,_){if(n&1&&(i(0,"div",22)(1,"p",23),c(2,"Vista previa:"),r(),b(3,"img",24),r()),n&2){let e=d(2);a(3),m("src",e.newProduct.imagenUrl,x)}}function ce(n,_){if(n&1){let e=C();i(0,"div",9),u("click",function(){l(e);let t=d();return s(t.toggleForm())}),i(1,"div",10),u("click",function(t){return l(e),s(t.stopPropagation())}),i(2,"button",11),u("click",function(){l(e);let t=d();return s(t.toggleForm())}),c(3,"\xD7"),r(),i(4,"form",12),u("ngSubmit",function(){l(e);let t=d();return s(t.onSubmitProduct())}),i(5,"h3"),c(6,"Cargar Nueva Vianda"),r(),i(7,"div",13)(8,"label"),c(9,"Nombre"),r(),i(10,"input",14),O("ngModelChange",function(t){l(e);let p=d();return w(p.newProduct.nombre,t)||(p.newProduct.nombre=t),s(t)}),r()(),i(11,"div",13)(12,"label"),c(13,"Descripci\xF3n"),r(),i(14,"textarea",15),O("ngModelChange",function(t){l(e);let p=d();return w(p.newProduct.descripcion,t)||(p.newProduct.descripcion=t),s(t)}),r()(),i(15,"div",13)(16,"label"),c(17,"Precio"),r(),i(18,"input",16),O("ngModelChange",function(t){l(e);let p=d();return w(p.newProduct.precio,t)||(p.newProduct.precio=t),s(t)}),r()(),i(19,"div",13)(20,"label"),c(21,"Foto del Producto"),r(),i(22,"input",17),u("change",function(t){l(e);let p=d();return s(p.onFileSelected(t))}),r(),f(23,re,2,0,"div",18)(24,ie,4,1,"div",19),r(),i(25,"button",20),c(26,"Guardar Producto"),r()()()()}if(n&2){let e=d();a(10),v("ngModel",e.newProduct.nombre),a(4),v("ngModel",e.newProduct.descripcion),a(4),v("ngModel",e.newProduct.precio),a(5),m("ngIf",e.isUploading),a(),m("ngIf",e.newProduct.imagenUrl)}}function ae(n,_){if(n&1){let e=C();i(0,"app-product-card",25),u("addToCart",function(t){l(e);let p=d();return s(p.addToCart(t))})("deleteProduct",function(t){l(e);let p=d();return s(p.deleteProduct(t))}),r()}if(n&2){let e=_.$implicit,o=d();m("product",e)("isAdmin",o.isAdmin)}}function de(n,_){n&1&&(i(0,"div",26)(1,"p"),c(2,"No hay productos disponibles en este momento."),r()())}var Ae=(()=>{class n{productoService=g(Q);cartService=g(Y);authService=g(H);uploadService=g(X);productos=[];isAdmin=!1;isUploading=!1;showForm=!1;newProduct={nombre:"",descripcion:"",precio:0,imagenUrl:"",activo:!0};ngOnInit(){this.loadProductos(),this.checkRole()}checkRole(){let e=this.authService.getUserRole();this.isAdmin=e==="ADMIN"}loadProductos(){this.productoService.getProductos().subscribe({next:e=>this.productos=e,error:e=>console.error("Error cargando productos",e)})}addToCart(e){this.cartService.addToCart(e),E.default.fire({title:"\xA1Agregado!",text:`${e.nombre} se agreg\xF3 al carrito`,icon:"success",toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,background:"#1a1a1a",color:"#f8edda",iconColor:"#edb110",customClass:{popup:"swal-custom-toast"}})}deleteProduct(e){E.default.fire({title:"\xBFEliminar Producto?",text:"Esta acci\xF3n no se puede deshacer",icon:"warning",showCancelButton:!0,confirmButtonColor:"#ff6b6b",cancelButtonColor:"#6c757d",confirmButtonText:"S\xED, eliminar",background:"#1a1a1a",color:"#f8edda"}).then(o=>{o.isConfirmed&&this.productoService.deleteProducto(e).subscribe({next:()=>{this.showSuccess("Producto eliminado"),this.productos=this.productos.filter(t=>t.id!==e),this.loadProductos()},error:t=>console.error("Error eliminando producto",t)})})}showSuccess(e){E.default.fire({icon:"success",title:"\xC9xito",text:e,timer:1500,showConfirmButton:!1,background:"#1a1a1a",color:"#f8edda"})}toggleForm(){this.showForm=!this.showForm}onFileSelected(e){let o=e.target.files[0];o&&(this.isUploading=!0,this.uploadService.uploadImage(o).subscribe({next:t=>{this.newProduct.imagenUrl=t.url,this.isUploading=!1},error:t=>{console.error("Error subiendo imagen",t),this.isUploading=!1,alert("Error al subir la imagen")}}))}onSubmitProduct(){this.productoService.createProducto(this.newProduct).subscribe({next:e=>{console.log("Producto creado",e),this.loadProductos(),this.toggleForm(),this.resetForm()},error:e=>console.error(e)})}resetForm(){this.newProduct={nombre:"",descripcion:"",precio:0,imagenUrl:"",activo:!0}}static \u0275fac=function(o){return new(o||n)};static \u0275cmp=M({type:n,selectors:[["app-menu"]],decls:12,vars:4,consts:[[1,"menu-container"],[1,"header-section"],["class","btn-create",3,"click",4,"ngIf"],["class","modal-overlay",3,"click",4,"ngIf"],[1,"products-grid"],[3,"product","isAdmin","addToCart","deleteProduct",4,"ngFor","ngForOf"],["class","no-products",4,"ngIf"],[1,"btn-create",3,"click"],[1,"fas","fa-plus"],[1,"modal-overlay",3,"click"],[1,"modal-content",3,"click"],[1,"close-btn",3,"click"],[1,"product-form",3,"ngSubmit"],[1,"form-group"],["name","nombre","required","","placeholder","Ej: Milanesa con pur\xE9",3,"ngModelChange","ngModel"],["name","descripcion","required","","placeholder","Ingredientes, calor\xEDas, etc.",3,"ngModelChange","ngModel"],["type","number","name","precio","required","",3,"ngModelChange","ngModel"],["type","file","accept","image/*",2,"padding","0.5rem","border","none",3,"change"],["style","color: #edb110; font-size: 0.9rem;",4,"ngIf"],["style","margin-top: 10px;",4,"ngIf"],["type","submit",1,"btn-submit"],[2,"color","#edb110","font-size","0.9rem"],[2,"margin-top","10px"],[2,"font-size","0.8rem","opacity","0.7","margin-bottom","5px"],["alt","Preview",2,"height","100px","border-radius","8px","border","1px solid #edb110",3,"src"],[3,"addToCart","deleteProduct","product","isAdmin"],[1,"no-products"]],template:function(o,t){o&1&&(b(0,"app-navbar"),i(1,"div",0)(2,"div",1)(3,"h1"),c(4,"Men\xFA de la Semana"),r(),i(5,"p"),c(6,"Eleg\xED tus viandas favoritas y arm\xE1 tu pedido."),r(),f(7,oe,3,1,"button",2),r(),f(8,ce,27,5,"div",3),i(9,"div",4),f(10,ae,1,2,"app-product-card",5),r(),f(11,de,3,0,"div",6),r()),o&2&&(a(7),m("ngIf",t.isAdmin),a(),m("ngIf",t.showForm&&t.isAdmin),a(2),m("ngForOf",t.productos),a(),m("ngIf",t.productos.length===0))},dependencies:[y,U,S,J,K,G,q,N,R,D,j,L,W,B],styles:['.menu-container[_ngcontent-%COMP%]{padding-top:100px!important;min-height:100vh;background-color:var(--bg-color);background-size:cover;background-attachment:fixed;font-family:Segoe UI,sans-serif;color:var(--text-color)}.menu-container[_ngcontent-%COMP%]:before{content:"";position:fixed;inset:0;background:var(--bg-color);opacity:.85;z-index:0;transition:background-color .3s ease}.header-section[_ngcontent-%COMP%], .products-grid[_ngcontent-%COMP%], .admin-form-container[_ngcontent-%COMP%], .no-products[_ngcontent-%COMP%]{position:relative;z-index:1;max-width:1200px;margin:0 auto;padding:0 1rem}.header-section[_ngcontent-%COMP%]{text-align:center;margin-bottom:3rem}.header-section[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:2.5rem;color:var(--primary-color);margin-bottom:.5rem}.header-section[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--text-muted);font-size:1.1rem}.header-section[_ngcontent-%COMP%]   .btn-create[_ngcontent-%COMP%]{margin-top:1.5rem;padding:.8rem 1.5rem;background:var(--primary-color);color:var(--bg-card);border:none;border-radius:8px;font-weight:700;cursor:pointer;transition:transform .2s}.header-section[_ngcontent-%COMP%]   .btn-create[_ngcontent-%COMP%]:hover{transform:scale(1.05)}.products-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:2rem;padding-bottom:4rem}@media (max-width: 768px){.products-grid[_ngcontent-%COMP%]{grid-template-columns:1fr;padding:0 1rem 4rem;gap:1.5rem}}.product-form[_ngcontent-%COMP%]{width:100%}.product-form[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{text-align:center;color:var(--primary-color);margin-bottom:1.5rem}.product-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{margin-bottom:1.2rem}.product-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:.5rem;font-size:.9rem;color:var(--text-color)}.product-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .product-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{width:100%;padding:.8rem;background:var(--bg-card);border:1px solid var(--border-color);border-radius:8px;color:var(--text-color);box-sizing:border-box}.product-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .product-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--primary-color);box-shadow:0 0 0 2px #edb11033}.product-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{resize:vertical;min-height:80px}.product-form[_ngcontent-%COMP%]   .btn-submit[_ngcontent-%COMP%]{width:100%;padding:1rem;background:var(--primary-color);color:var(--bg-color);border:none;border-radius:8px;font-weight:700;font-size:1rem;cursor:pointer;margin-top:1rem}.product-form[_ngcontent-%COMP%]   .btn-submit[_ngcontent-%COMP%]:hover{filter:brightness(1.1)}.no-products[_ngcontent-%COMP%]{text-align:center;padding:3rem;background:var(--bg-card);border:1px solid var(--border-color);border-radius:12px;color:var(--text-color)}']})}return n})();export{Ae as MenuComponent};
