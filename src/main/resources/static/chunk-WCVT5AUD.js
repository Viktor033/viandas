import{C as p,F as s,H as o,I as r,J as _,K as b,L as g,M as f,N as a,O as x,P as u,V as h,W as O,X as T,d as E,da as A,ea as I,fa as k,ha as N,ia as y,j as P,ka as L,m as d,o as v,oa as j,p as C,pa as z,qa as F,sa as $,v as c,y as M}from"./chunk-DKIOLES6.js";var w=(()=>{class e{cartItems=new E([]);cart$=this.cartItems.asObservable();addToCart(t){let n=this.cartItems.value,i=n.find(m=>m.producto.id===t.id);i?(i.cantidad++,this.cartItems.next([...n])):this.cartItems.next([...n,{producto:t,cantidad:1}]),console.log("Carrito actualizado:",this.cartItems.value)}removeFromCart(t){let n=this.cartItems.value.filter(i=>i.producto.id!==t);this.cartItems.next(n)}clearCart(){this.cartItems.next([])}getTotal(){return this.cartItems.value.reduce((t,n)=>t+n.producto.precio*n.cantidad,0)}static \u0275fac=function(n){return new(n||e)};static \u0275prov=P({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var V=(()=>{class e{http=d(L);apiUrl="/api/pedidos";crearPedido(t){return this.http.post(this.apiUrl,{items:t})}getMisPedidos(){return this.http.get(`${this.apiUrl}/mis-pedidos`)}static \u0275fac=function(n){return new(n||e)};static \u0275prov=P({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function U(e,l){e&1&&(o(0,"div",8)(1,"p"),a(2,"No tienes productos en el carrito."),r()())}function B(e,l){if(e&1){let t=b();o(0,"div",9)(1,"div",10)(2,"span",11),a(3),r(),o(4,"span",12),a(5),r()(),o(6,"div",13)(7,"span",14),a(8),r(),o(9,"button",15),g("click",function(){let i=v(t).$implicit,m=f(2);return C(m.removeItem(i.producto.id))}),_(10,"i",16),a(11," Eliminar "),r()()()}if(e&2){let t=l.$implicit;c(3),x(t.producto.nombre),c(2),u("$ ",t.producto.precio,""),c(3),u("x ",t.cantidad,"")}}function H(e,l){if(e&1){let t=b();o(0,"div",17)(1,"div",18)(2,"span"),a(3,"Total:"),r(),o(4,"span",19),a(5),h(6,"number"),r()(),o(7,"button",20),g("click",function(){v(t);let i=f().ngIf,m=f();return C(m.confirmOrder(i))}),a(8),r()()}if(e&2){let t=f(2);c(5),u("$ ",T(6,3,t.total,"1.0-0"),""),c(2),s("disabled",t.isProcessing),c(),u(" ",t.isProcessing?"Procesando...":"Confirmar Pedido"," ")}}function G(e,l){if(e&1&&(o(0,"div",4),p(1,U,3,0,"div",5)(2,B,12,3,"div",6)(3,H,9,6,"div",7),r()),e&2){let t=l.ngIf;c(),s("ngIf",t.length===0),c(),s("ngForOf",t),c(),s("ngIf",t.length>0)}}var D=(()=>{class e{cartService=d(w);pedidoService=d(V);router=d(j);cartItems$=this.cartService.cart$;total=0;isProcessing=!1;ngOnInit(){this.cartItems$.subscribe(t=>{this.total=t.reduce((n,i)=>n+i.producto.precio*i.cantidad,0)})}close(){}removeItem(t){t&&this.cartService.removeFromCart(t)}confirmOrder(t){if(t.length===0)return;this.isProcessing=!0;let n=t.map(i=>({productoId:i.producto.id,cantidad:i.cantidad}));this.pedidoService.crearPedido(n).subscribe({next:i=>{alert("\xA1Pedido confirmado!"),this.cartService.clearCart(),this.isProcessing=!1,this.closeModal(),this.router.navigate(["/mis-pedidos"])},error:i=>{console.error(i),alert("Error al confirmar pedido"),this.isProcessing=!1}})}closeModal(){let t=document.querySelector(".modal-overlay");t&&(t.classList.add("hidden"),this.closeRequest())}closeRequest(){document.dispatchEvent(new CustomEvent("closeCart"))}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=M({type:e,selectors:[["app-cart"]],decls:8,vars:3,consts:[[1,"modal-overlay",3,"click"],[1,"modal-content",3,"click"],[1,"close-btn",3,"click"],["class","cart-items",4,"ngIf"],[1,"cart-items"],["class","empty-cart",4,"ngIf"],["class","cart-item",4,"ngFor","ngForOf"],["class","cart-footer",4,"ngIf"],[1,"empty-cart"],[1,"cart-item"],[1,"item-info"],[1,"item-name"],[1,"item-price"],[1,"item-controls"],[1,"qty"],[1,"btn-remove",3,"click"],[1,"fas","fa-trash"],[1,"cart-footer"],[1,"total-row"],[1,"total-amount"],[1,"btn-confirm",3,"click","disabled"]],template:function(n,i){n&1&&(o(0,"div",0),g("click",function(){return i.closeRequest()}),o(1,"div",1),g("click",function(R){return R.stopPropagation()}),o(2,"button",2),g("click",function(){return i.closeRequest()}),a(3,"\xD7"),r(),o(4,"h2"),a(5,"Tu Carrito"),r(),p(6,G,4,3,"div",3),h(7,"async"),r()()),n&2&&(c(6),s("ngIf",O(7,1,i.cartItems$)))},dependencies:[y,A,I,k,N],styles:[".cart-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:1rem 0;border-bottom:1px solid rgba(255,255,255,.1)}.cart-item[_ngcontent-%COMP%]   .item-info[_ngcontent-%COMP%]{display:flex;flex-direction:column}.cart-item[_ngcontent-%COMP%]   .item-info[_ngcontent-%COMP%]   .item-name[_ngcontent-%COMP%]{font-weight:600;color:#f8edda}.cart-item[_ngcontent-%COMP%]   .item-info[_ngcontent-%COMP%]   .item-price[_ngcontent-%COMP%]{color:#edb110;font-size:.9rem}.cart-item[_ngcontent-%COMP%]   .item-controls[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem}.cart-item[_ngcontent-%COMP%]   .item-controls[_ngcontent-%COMP%]   .qty[_ngcontent-%COMP%]{background:#ffffff1a;padding:.2rem .6rem;border-radius:4px}.cart-item[_ngcontent-%COMP%]   .item-controls[_ngcontent-%COMP%]   .btn-remove[_ngcontent-%COMP%]{background:none;border:none;color:#ff6b6b;cursor:pointer;font-size:.8rem}.cart-item[_ngcontent-%COMP%]   .item-controls[_ngcontent-%COMP%]   .btn-remove[_ngcontent-%COMP%]:hover{text-decoration:underline}.cart-footer[_ngcontent-%COMP%]{margin-top:2rem}.cart-footer[_ngcontent-%COMP%]   .total-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;font-size:1.2rem;font-weight:700;margin-bottom:1.5rem;color:#edb110}.cart-footer[_ngcontent-%COMP%]   .btn-confirm[_ngcontent-%COMP%]{width:100%;padding:1rem;background:#edb110;color:#0a332e;border:none;border-radius:8px;font-weight:700;font-size:1.1rem;cursor:pointer;transition:filter .2s}.cart-footer[_ngcontent-%COMP%]   .btn-confirm[_ngcontent-%COMP%]:hover{filter:brightness(1.1)}.cart-footer[_ngcontent-%COMP%]   .btn-confirm[_ngcontent-%COMP%]:disabled{background:#666;cursor:not-allowed}.empty-cart[_ngcontent-%COMP%]{text-align:center;padding:3rem 0;color:#f8edda80}"]})}return e})();function J(e,l){e&1&&(o(0,"li")(1,"a",16),a(2,"Mis pedidos"),r()())}function K(e,l){if(e&1&&(o(0,"span",20),a(1),r()),e&2){let t=l.ngIf;c(),x(t)}}function Q(e,l){if(e&1){let t=b();o(0,"div",17),g("click",function(){v(t);let i=f();return C(i.toggleCart())}),_(1,"i",18),p(2,K,2,1,"span",19),h(3,"async"),r()}if(e&2){let t,n=f();c(2),s("ngIf",(t=O(3,1,n.cartService.cart$))==null?null:t.length)}}function W(e,l){e&1&&_(0,"app-cart")}var vt=(()=>{class e{authService=d($);cartService=d(w);userName="Usuario";isAdmin=!1;showCart=!1;ngOnInit(){this.userName=this.authService.getCurrentUser()||"Usuario",this.isAdmin=this.authService.getUserRole()==="ADMIN",document.addEventListener("closeCart",()=>{this.showCart=!1})}toggleCart(){this.showCart=!this.showCart}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=M({type:e,selectors:[["app-navbar"]],decls:27,vars:5,consts:[[1,"navbar"],[1,"navbar-container"],[1,"logo-section"],["src","/assets/images/logonew.png","alt","Manoplas Logo",1,"nav-logo"],[1,"brand-name"],[1,"nav-links"],["routerLink","/home","routerLinkActive","active"],["routerLink","/menu","routerLinkActive","active"],[4,"ngIf"],["routerLink","/contacto","routerLinkActive","active"],[1,"user-section"],["class","cart-trigger",3,"click",4,"ngIf"],[1,"user-info"],[1,"greeting"],[1,"username"],[1,"avatar-circle"],["routerLink","/mis-pedidos","routerLinkActive","active"],[1,"cart-trigger",3,"click"],[1,"fas","fa-shopping-cart"],["class","badge",4,"ngIf"],[1,"badge"]],template:function(n,i){n&1&&(o(0,"nav",0)(1,"div",1)(2,"div",2),_(3,"img",3),o(4,"span",4),a(5,"MANOPLAS"),r()(),o(6,"ul",5)(7,"li")(8,"a",6),a(9,"Inicio"),r()(),o(10,"li")(11,"a",7),a(12,"Men\xFA de la semana"),r()(),p(13,J,3,0,"li",8),o(14,"li")(15,"a",9),a(16,"Contactanos"),r()()(),o(17,"div",10),p(18,Q,4,3,"div",11),o(19,"div",12)(20,"span",13),a(21,"Hola,"),r(),o(22,"span",14),a(23),r()(),o(24,"div",15),a(25),r()()()(),p(26,W,1,0,"app-cart",8)),n&2&&(c(13),s("ngIf",!i.isAdmin),c(5),s("ngIf",!i.isAdmin),c(5),x(i.userName),c(2),u(" ",i.userName.charAt(0)," "),c(),s("ngIf",i.showCart))},dependencies:[y,I,k,z,F,D],styles:['[_nghost-%COMP%]{display:block;width:100%;position:fixed;top:0;left:0;z-index:1000}.navbar[_ngcontent-%COMP%]{background:#141414d9;backdrop-filter:blur(10px);-webkit-backdrop-filter:blur(10px);border-bottom:1px solid rgba(237,177,16,.2);padding:.8rem 2rem;box-shadow:0 4px 30px #0000004d}.navbar-container[_ngcontent-%COMP%]{max-width:1400px;margin:0 auto;display:flex;justify-content:space-between;align-items:center}.logo-section[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem;cursor:pointer}.logo-section[_ngcontent-%COMP%]   .nav-logo[_ngcontent-%COMP%]{height:50px;width:auto;filter:drop-shadow(0 2px 4px rgba(0,0,0,.2))}.logo-section[_ngcontent-%COMP%]   .brand-name[_ngcontent-%COMP%]{color:#f8edda;font-size:1.2rem;font-weight:700;letter-spacing:1px}.nav-links[_ngcontent-%COMP%]{list-style:none;display:flex;gap:2.5rem;margin:0;padding:0}.nav-links[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-decoration:none;color:#f8eddab3;font-size:.95rem;font-weight:500;transition:all .3s ease;padding:.5rem 0;position:relative}.nav-links[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:after{content:"";position:absolute;bottom:0;left:0;width:0;height:2px;background-color:#edb110;transition:width .3s ease}.nav-links[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, .nav-links[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a.active[_ngcontent-%COMP%]{color:#edb110}.nav-links[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover:after, .nav-links[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a.active[_ngcontent-%COMP%]:after{width:100%}.user-section[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem;padding-left:2rem;border-left:1px solid rgba(248,237,218,.1)}.user-section[_ngcontent-%COMP%]   .cart-trigger[_ngcontent-%COMP%]{position:relative;margin-right:1.5rem;color:#f8edda;font-size:1.2rem;cursor:pointer;transition:transform .2s}.user-section[_ngcontent-%COMP%]   .cart-trigger[_ngcontent-%COMP%]:hover{transform:scale(1.1);color:#edb110}.user-section[_ngcontent-%COMP%]   .cart-trigger[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%]{position:absolute;top:-8px;right:-8px;background:#edb110;color:#0a332e;font-size:.7rem;font-weight:700;width:18px;height:18px;border-radius:50%;display:flex;justify-content:center;align-items:center}.user-section[_ngcontent-%COMP%]   .user-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-end;line-height:1.2}.user-section[_ngcontent-%COMP%]   .user-info[_ngcontent-%COMP%]   .greeting[_ngcontent-%COMP%]{font-size:.75rem;color:#f8edda80}.user-section[_ngcontent-%COMP%]   .user-info[_ngcontent-%COMP%]   .username[_ngcontent-%COMP%]{color:#f8edda;font-weight:600;font-size:.9rem}.user-section[_ngcontent-%COMP%]   .avatar-circle[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:50%;background:#edb11033;border:1px solid #edb110;color:#edb110;display:flex;align-items:center;justify-content:center;font-weight:700;font-size:1.1rem;transition:transform .3s ease}.user-section[_ngcontent-%COMP%]   .avatar-circle[_ngcontent-%COMP%]:hover{transform:scale(1.05);background:#edb110;color:#0a332e}']})}return e})();export{w as a,V as b,vt as c};
