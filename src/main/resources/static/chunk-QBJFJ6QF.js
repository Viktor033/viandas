import{a as R}from"./chunk-ZRCKKCIW.js";import{c as J,d as G}from"./chunk-DBZRNEX3.js";import{$ as F,A as g,B as C,H as A,I as k,M as V,O as I,X as W,Y as T,Z as z,_ as N,aa as D,c as $,da as B,e as y,ea as L,f as M,fa as U,g as s,ga as j,h as m,ha as q,k as c,l as S,m as b,n as _,o as E,p as i,q as o,r as h,s as O,t as u,u as d,v as a,w as x,x as P,y as w,z as p}from"./chunk-INERZMVE.js";var Z=(()=>{class l{http=M(I);apiUrl="/api/usuarios";getClientes(){return this.http.get(this.apiUrl)}getCliente(e){return this.http.get(`${this.apiUrl}/${e}`)}createCliente(e){return e.rol||(e.rol="USUARIO"),this.http.post(this.apiUrl,e)}updateCliente(e,n){return this.http.put(`${this.apiUrl}/${e}`,n)}deleteCliente(e){return this.http.delete(`${this.apiUrl}/${e}`)}static \u0275fac=function(n){return new(n||l)};static \u0275prov=y({token:l,factory:l.\u0275fac,providedIn:"root"})}return l})();var v=$(J());function K(l,f){if(l&1&&(i(0,"span",17),a(1),o()),l&2){let e=d().$implicit;c(),w(" (",e.piso," ",e.departamento,") ")}}function Q(l,f){if(l&1&&(i(0,"span",18),a(1),o()),l&2){let e=d().$implicit;c(),x(e.zona)}}function X(l,f){if(l&1){let e=O();i(0,"tr")(1,"td"),a(2),o(),i(3,"td"),a(4),o(),i(5,"td"),a(6),b(7,K,2,2,"span",9),o(),i(8,"td"),b(9,Q,2,1,"span",10),o(),i(10,"td")(11,"span",11),a(12),o()(),i(13,"td",12)(14,"button",13),u("click",function(){let t=s(e).$implicit,r=d();return m(r.printFicha(t))}),h(15,"i",14),o(),i(16,"button",15),u("click",function(){let t=s(e).$implicit,r=d();return m(r.openModal(t))}),h(17,"i",16),o()()()}if(l&2){let e=f.$implicit;c(2),w("",e.nombre," ",e.apellido,""),c(2),x(e.telefono),c(2),P(" ",e.direccion," "),c(),_("ngIf",e.piso||e.departamento),c(2),_("ngIf",e.zona),c(2),E("assigned",e.cadete),c(),P(" ",e.cadete?e.cadete.nombre:"Sin asignar"," ")}}function Y(l,f){l&1&&(i(0,"tr")(1,"td",19),a(2,"No hay clientes registrados"),o()())}function ee(l,f){if(l&1&&(i(0,"option",37),a(1),o()),l&2){let e=f.$implicit;_("ngValue",e),c(),w(" ",e.nombre," (",e.vehiculo,") ")}}function te(l,f){if(l&1){let e=O();i(0,"div",20),u("click",function(){s(e);let t=d();return m(t.closeModal())}),i(1,"div",21),u("click",function(t){return s(e),m(t.stopPropagation())}),i(2,"button",22),u("click",function(){s(e);let t=d();return m(t.closeModal())}),a(3,"\xD7"),o(),i(4,"h2"),a(5),o(),i(6,"form",23),u("ngSubmit",function(){s(e);let t=d();return m(t.saveCliente())}),i(7,"div",24)(8,"div",25)(9,"label"),a(10,"Nombre"),o(),i(11,"input",26),C("ngModelChange",function(t){s(e);let r=d();return g(r.currentCliente.nombre,t)||(r.currentCliente.nombre=t),m(t)}),o()(),i(12,"div",25)(13,"label"),a(14,"Apellido"),o(),i(15,"input",27),C("ngModelChange",function(t){s(e);let r=d();return g(r.currentCliente.apellido,t)||(r.currentCliente.apellido=t),m(t)}),o()()(),i(16,"div",28)(17,"label"),a(18,"Tel\xE9fono (ID Acceso)"),o(),i(19,"input",29),C("ngModelChange",function(t){s(e);let r=d();return g(r.currentCliente.telefono,t)||(r.currentCliente.telefono=t),m(t)}),o()(),i(20,"div",28)(21,"label"),a(22,"Direcci\xF3n"),o(),i(23,"input",30),C("ngModelChange",function(t){s(e);let r=d();return g(r.currentCliente.direccion,t)||(r.currentCliente.direccion=t),m(t)}),o()(),i(24,"div",24)(25,"div",31)(26,"label"),a(27,"Piso"),o(),i(28,"input",32),C("ngModelChange",function(t){s(e);let r=d();return g(r.currentCliente.piso,t)||(r.currentCliente.piso=t),m(t)}),o()(),i(29,"div",31)(30,"label"),a(31,"Depto"),o(),i(32,"input",33),C("ngModelChange",function(t){s(e);let r=d();return g(r.currentCliente.departamento,t)||(r.currentCliente.departamento=t),m(t)}),o()(),i(33,"div",31)(34,"label"),a(35,"Zona"),o(),i(36,"input",34),C("ngModelChange",function(t){s(e);let r=d();return g(r.currentCliente.zona,t)||(r.currentCliente.zona=t),m(t)}),o()()(),i(37,"div",28)(38,"label"),a(39,"Observaciones"),o(),i(40,"textarea",35),C("ngModelChange",function(t){s(e);let r=d();return g(r.currentCliente.observaciones,t)||(r.currentCliente.observaciones=t),m(t)}),o()(),i(41,"div",28)(42,"label"),a(43,"Cadete Asignado"),o(),i(44,"select",36),C("ngModelChange",function(t){s(e);let r=d();return g(r.currentCliente.cadete,t)||(r.currentCliente.cadete=t),m(t)}),i(45,"option",37),a(46,"-- Sin Asignar --"),o(),b(47,ee,2,3,"option",38),o()(),i(48,"button",39),a(49,"Guardar"),o()()()()}if(l&2){let e=d();c(5),x(e.isEditing?"Editar Cliente":"Nuevo Cliente"),c(6),p("ngModel",e.currentCliente.nombre),c(4),p("ngModel",e.currentCliente.apellido),c(4),p("ngModel",e.currentCliente.telefono),c(4),p("ngModel",e.currentCliente.direccion),c(5),p("ngModel",e.currentCliente.piso),c(4),p("ngModel",e.currentCliente.departamento),c(4),p("ngModel",e.currentCliente.zona),c(4),p("ngModel",e.currentCliente.observaciones),c(4),p("ngModel",e.currentCliente.cadete),c(),_("ngValue",null),c(2),_("ngForOf",e.cadetes)}}var _e=(()=>{class l{clienteService=M(Z);cadeteService=M(R);clientes=[];cadetes=[];showModal=!1;isEditing=!1;currentCliente=this.getEmptyCliente();ngOnInit(){this.loadClientes(),this.loadCadetes()}loadClientes(){this.clienteService.getClientes().subscribe({next:e=>this.clientes=e.filter(n=>n.rol!=="ADMIN"),error:e=>console.error(e)})}loadCadetes(){this.cadeteService.getCadetes().subscribe({next:e=>this.cadetes=e.filter(n=>n.activo),error:e=>console.error(e)})}openModal(e){if(e){if(this.isEditing=!0,this.currentCliente=JSON.parse(JSON.stringify(e)),this.currentCliente.cadete){let n=this.cadetes.find(t=>t.id===this.currentCliente.cadete?.id);n&&(this.currentCliente.cadete=n)}}else this.isEditing=!1,this.currentCliente=this.getEmptyCliente();this.showModal=!0}closeModal(){this.showModal=!1}saveCliente(){(this.isEditing&&this.currentCliente.id?this.clienteService.updateCliente(this.currentCliente.id,this.currentCliente):this.clienteService.createCliente(this.currentCliente)).subscribe({next:()=>{this.showSuccess(this.isEditing?"Cliente actualizado":"Cliente creado"),this.loadClientes(),this.closeModal()},error:n=>{let t=n.error?.message||n.message||"Error desconocido";this.showError(`Error: ${t}`)}})}printFicha(e){let n=window.open("","","height=600,width=800");n&&(n.document.write("<html><head><title>Ficha de Cliente</title>"),n.document.write("<style>"),n.document.write("body { font-family: Arial, sans-serif; padding: 20px; }"),n.document.write(".header { text-align: center; border-bottom: 2px solid #333; margin-bottom: 20px; }"),n.document.write(".row { margin-bottom: 15px; font-size: 1.2rem; }"),n.document.write(".label { font-weight: bold; width: 150px; display: inline-block; }"),n.document.write(".zone-tag { border: 2px solid black; padding: 5px 10px; font-size: 1.5rem; font-weight: bold; }"),n.document.write("</style>"),n.document.write("</head><body>"),n.document.write('<div class="header"><h1>Ficha de Entrega - MANOPLAS</h1></div>'),n.document.write(`<div class="row"><span class="label">Cliente:</span> ${e.nombre} ${e.apellido}</div>`),n.document.write(`<div class="row"><span class="label">Tel\xE9fono:</span> ${e.telefono}</div>`),n.document.write(`<div class="row"><span class="label">Direcci\xF3n:</span> ${e.direccion||"-"}</div>`),(e.piso||e.departamento)&&n.document.write(`<div class="row"><span class="label">Piso/Depto:</span> ${e.piso||""} ${e.departamento||""}</div>`),n.document.write(`<div class="row"><span class="label">Zona:</span> <span class="zone-tag">${e.zona||"SIN ZONA"}</span></div>`),n.document.write(`<div class="row"><span class="label">Observaciones:</span> ${e.observaciones||"Ninguna"}</div>`),n.document.write(`<div class="row"><span class="label">Cadete Asignado:</span> ${e.cadete?e.cadete.nombre:"NO ASIGNADO"}</div>`),n.document.write("</body></html>"),n.document.close(),n.print())}getEmptyCliente(){return{nombre:"",apellido:"",telefono:"",rol:"USUARIO",activo:!0,zona:"",direccion:"",piso:"",departamento:"",observaciones:""}}showSuccess(e){v.default.fire({icon:"success",title:"\xC9xito",text:e,timer:1500,showConfirmButton:!1,background:"#1a1a1a",color:"#f8edda"})}showError(e){v.default.fire({icon:"error",title:"Error",text:e,background:"#1a1a1a",color:"#f8edda"})}static \u0275fac=function(n){return new(n||l)};static \u0275cmp=S({type:l,selectors:[["app-admin-clientes"]],decls:28,vars:3,consts:[[1,"dashboard-container"],[1,"header-section"],[1,"btn-primary",3,"click"],[1,"fas","fa-plus"],[1,"table-responsive"],[1,"clientes-table"],[4,"ngFor","ngForOf"],[4,"ngIf"],["class","modal-overlay",3,"click",4,"ngIf"],["class","small-text",4,"ngIf"],["class","badge zona",4,"ngIf"],[1,"badge","cadete"],[1,"actions-cell"],["title","Imprimir Ficha",1,"btn-icon","print",3,"click"],[1,"fas","fa-print"],["title","Editar",1,"btn-icon","edit",3,"click"],[1,"fas","fa-edit"],[1,"small-text"],[1,"badge","zona"],["colspan","6",1,"empty-message"],[1,"modal-overlay",3,"click"],[1,"modal-content",3,"click"],[1,"close-btn",3,"click"],[3,"ngSubmit"],[1,"form-row"],[1,"form-group","half"],["name","nombre","required","",3,"ngModelChange","ngModel"],["name","apellido","required","",3,"ngModelChange","ngModel"],[1,"form-group"],["name","telefono","required","",3,"ngModelChange","ngModel"],["name","direccion","placeholder","Calle y Altura",3,"ngModelChange","ngModel"],[1,"form-group","third"],["name","piso",3,"ngModelChange","ngModel"],["name","depto",3,"ngModelChange","ngModel"],["name","zona","placeholder","Ej: CENTRO",3,"ngModelChange","ngModel"],["name","obs","rows","2",3,"ngModelChange","ngModel"],["name","cadete",3,"ngModelChange","ngModel"],[3,"ngValue"],[3,"ngValue",4,"ngFor","ngForOf"],["type","submit",1,"btn-submit"]],template:function(n,t){n&1&&(h(0,"app-navbar"),i(1,"div",0)(2,"div",1)(3,"h1"),a(4,"Gesti\xF3n de Clientes"),o(),i(5,"button",2),u("click",function(){return t.openModal()}),h(6,"i",3),a(7," Nuevo Cliente "),o()(),i(8,"div",4)(9,"table",5)(10,"thead")(11,"tr")(12,"th"),a(13,"Nombre y Apellido"),o(),i(14,"th"),a(15,"Tel\xE9fono"),o(),i(16,"th"),a(17,"Direcci\xF3n"),o(),i(18,"th"),a(19,"Zona"),o(),i(20,"th"),a(21,"Cadete"),o(),i(22,"th"),a(23,"Acciones"),o()()(),i(24,"tbody"),b(25,X,18,9,"tr",6)(26,Y,3,0,"tr",7),o()()()(),b(27,te,50,12,"div",8)),n&2&&(c(25),_("ngForOf",t.clientes),c(),_("ngIf",t.clientes.length===0),c(),_("ngIf",t.showModal))},dependencies:[V,A,k,G,q,D,L,U,W,B,T,z,j,F,N],styles:[".dashboard-container[_ngcontent-%COMP%]{padding:2rem;max-width:1400px;margin:80px auto 0;color:#f8edda}.header-section[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:2rem}.header-section[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:2.5rem;color:#edb110;text-transform:uppercase;letter-spacing:2px}.header-section[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]{background:#edb110;color:#0a332e;border:none;padding:.8rem 1.5rem;border-radius:8px;font-weight:700;cursor:pointer;transition:transform .2s}.header-section[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]:hover{transform:scale(1.05)}.table-responsive[_ngcontent-%COMP%]{background:#ffffff0d;border-radius:12px;padding:1rem;backdrop-filter:blur(10px);border:1px solid rgba(237,177,16,.1);overflow-x:auto}.clientes-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;min-width:900px}.clientes-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .clientes-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:1rem;text-align:left;border-bottom:1px solid rgba(255,255,255,.1)}.clientes-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{color:#edb110;text-transform:uppercase;font-size:.9rem}.clientes-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:.95rem;vertical-align:middle}.clientes-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .small-text[_ngcontent-%COMP%]{font-size:.8rem;color:#f8edda99;display:block}.clientes-table[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%]{padding:.3rem .8rem;border-radius:20px;font-size:.8rem;font-weight:700}.clientes-table[_ngcontent-%COMP%]   .badge.zona[_ngcontent-%COMP%]{background:#ffffff1a;color:#edb110;border:1px solid rgba(237,177,16,.3)}.clientes-table[_ngcontent-%COMP%]   .badge.cadete[_ngcontent-%COMP%]{background:#ffffff0d;color:#f8edda80}.clientes-table[_ngcontent-%COMP%]   .badge.cadete.assigned[_ngcontent-%COMP%]{background:#edb11033;color:#f8edda}.clientes-table[_ngcontent-%COMP%]   .actions-cell[_ngcontent-%COMP%]{display:flex;gap:.5rem}.clientes-table[_ngcontent-%COMP%]   .btn-icon[_ngcontent-%COMP%]{background:none;border:none;cursor:pointer;padding:.5rem;border-radius:50%;transition:background .2s}.clientes-table[_ngcontent-%COMP%]   .btn-icon[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1.1rem}.clientes-table[_ngcontent-%COMP%]   .btn-icon.edit[_ngcontent-%COMP%]{color:#f8edda}.clientes-table[_ngcontent-%COMP%]   .btn-icon.edit[_ngcontent-%COMP%]:hover{background:#ffffff1a}.clientes-table[_ngcontent-%COMP%]   .btn-icon.print[_ngcontent-%COMP%]{color:#edb110}.clientes-table[_ngcontent-%COMP%]   .btn-icon.print[_ngcontent-%COMP%]:hover{background:#edb1101a}.clientes-table[_ngcontent-%COMP%]   .empty-message[_ngcontent-%COMP%]{text-align:center;padding:2rem;opacity:.6}.modal-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:#000c;display:flex;justify-content:center;align-items:center;z-index:1000}.modal-content[_ngcontent-%COMP%]{background:#1a1a1a;padding:2rem;border-radius:12px;width:90%;max-width:600px;border:1px solid #edb110;color:#f8edda;position:relative;max-height:90vh;overflow-y:auto}.modal-content[_ngcontent-%COMP%]   .close-btn[_ngcontent-%COMP%]{position:absolute;top:1rem;right:1rem;background:none;border:none;color:#f8edda;font-size:1.5rem;cursor:pointer}.modal-content[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#edb110;margin-bottom:2rem;text-align:center;border-bottom:1px solid rgba(237,177,16,.2);padding-bottom:1rem}.modal-content[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem}.modal-content[_ngcontent-%COMP%]   .form-row[_ngcontent-%COMP%]{display:flex;gap:1rem}.modal-content[_ngcontent-%COMP%]   .form-row[_ngcontent-%COMP%]   .half[_ngcontent-%COMP%], .modal-content[_ngcontent-%COMP%]   .form-row[_ngcontent-%COMP%]   .third[_ngcontent-%COMP%]{flex:1}.modal-content[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:.5rem;color:#edb110;font-size:.9rem}.modal-content[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .modal-content[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%], .modal-content[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{width:100%;padding:.8rem;background:#ffffff0d;border:1px solid rgba(255,255,255,.1);color:#f8edda;border-radius:6px;font-family:inherit}.modal-content[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .modal-content[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus, .modal-content[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:focus{outline:none;border-color:#edb110}.modal-content[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{resize:vertical}.modal-content[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]   option[_ngcontent-%COMP%]{background:#1a1a1a;color:#f8edda}.modal-content[_ngcontent-%COMP%]   .btn-submit[_ngcontent-%COMP%]{margin-top:1rem;padding:1rem;background:#edb110;color:#0a332e;border:none;border-radius:8px;font-weight:700;cursor:pointer}.modal-content[_ngcontent-%COMP%]   .btn-submit[_ngcontent-%COMP%]:hover{filter:brightness(1.1)}@media (max-width: 768px){.form-row[_ngcontent-%COMP%]{flex-direction:column;gap:0}}"]})}return l})();export{_e as AdminClientesComponent};
